<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #2196F3;
            border-radius: 4px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        textarea {
            width: 100%;
            font-family: monospace;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h1>
        
        <div class="section">
            <h2>Firebase Configuration</h2>
            <div id="configStatus" class="status info">
                ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Firebase Config
            </div>
            <textarea id="firebaseConfig" rows="10" placeholder='Paste Firebase config here:
{
  "apiKey": "...",
  "authDomain": "...",
  "projectId": "...",
  "storageBucket": "...",
  "messagingSenderId": "...",
  "appId": "..."
}'></textarea>
            <button onclick="initializeFirebase()">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase</button>
        </div>

        <div class="section">
            <h2>Authentication (‡∏ï‡πâ‡∏≠‡∏á Login ‡∏î‡πâ‡∏ß‡∏¢ Admin)</h2>
            <div id="authStatus" class="status info">
                ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login
            </div>
            <button id="loginBtn" onclick="loginWithGoogle()" disabled>Login ‡∏î‡πâ‡∏ß‡∏¢ Google</button>
            <button id="logoutBtn" onclick="logout()" disabled style="display:none;">Logout</button>
        </div>

        <div class="section">
            <h2>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
            <button id="addBtn" onclick="addTestEquipment()" disabled>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
            <button id="checkBtn" onclick="checkEquipment()" disabled>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
        </div>

        <div id="results"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        let app, auth, db, currentUser;

        const testEquipment = [
            {
                name: 'MacBook Pro 16"',
                category: '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Ñ',
                brand: 'Apple',
                model: 'MacBook Pro 2023',
                serialNumber: 'MBP-2023-001',
                description: 'MacBook Pro 16 ‡∏ô‡∏¥‡πâ‡∏ß M2 Max RAM 32GB SSD 1TB',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 301'
            },
            {
                name: 'Dell XPS 15',
                category: '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Ñ',
                brand: 'Dell',
                model: 'XPS 15 9520',
                serialNumber: 'DELL-XPS-002',
                description: 'Dell XPS 15 Intel i7 RAM 16GB SSD 512GB',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 301'
            },
            {
                name: 'iPad Pro 12.9"',
                category: '‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï',
                brand: 'Apple',
                model: 'iPad Pro 2022',
                serialNumber: 'IPAD-PRO-003',
                description: 'iPad Pro 12.9 ‡∏ô‡∏¥‡πâ‡∏ß M2 256GB ‡∏û‡∏£‡πâ‡∏≠‡∏° Apple Pencil',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 302'
            },
            {
                name: 'Canon EOS R6',
                category: '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ',
                brand: 'Canon',
                model: 'EOS R6',
                serialNumber: 'CANON-R6-004',
                description: '‡∏Å‡∏•‡πâ‡∏≠‡∏á Mirrorless Full Frame ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡∏ô‡∏™‡πå 24-105mm',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠ 201'
            },
            {
                name: 'Sony A7 IV',
                category: '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ',
                brand: 'Sony',
                model: 'A7 IV',
                serialNumber: 'SONY-A7-005',
                description: '‡∏Å‡∏•‡πâ‡∏≠‡∏á Mirrorless Full Frame 33MP',
                status: 'borrowed',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠ 201'
            },
            {
                name: 'DJI Mavic 3',
                category: '‡πÇ‡∏î‡∏£‡∏ô',
                brand: 'DJI',
                model: 'Mavic 3',
                serialNumber: 'DJI-M3-006',
                description: '‡πÇ‡∏î‡∏£‡∏ô‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û 4K Hasselblad Camera',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠ 202'
            },
            {
                name: 'Rode Wireless GO II',
                category: '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô',
                brand: 'Rode',
                model: 'Wireless GO II',
                serialNumber: 'RODE-WG2-007',
                description: '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢ 2 ‡∏ï‡∏±‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏Ñ‡∏™',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠ 202'
            },
            {
                name: 'Logitech MX Master 3',
                category: '‡πÄ‡∏°‡∏≤‡∏™‡πå',
                brand: 'Logitech',
                model: 'MX Master 3',
                serialNumber: 'LOGI-MX3-008',
                description: '‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏£‡πâ‡∏™‡∏≤‡∏¢ Ergonomic Design',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 301'
            },
            {
                name: 'Keychron K8',
                category: '‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î',
                brand: 'Keychron',
                model: 'K8 Pro',
                serialNumber: 'KEY-K8-009',
                description: '‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏°‡∏Ñ‡∏≤‡∏ô‡∏¥‡∏Ñ‡∏±‡∏• Wireless Hot-swappable',
                status: 'available',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 302'
            },
            {
                name: 'BenQ SW270C',
                category: '‡∏à‡∏≠‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                brand: 'BenQ',
                model: 'SW270C',
                serialNumber: 'BENQ-SW-010',
                description: '‡∏à‡∏≠‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå 27 ‡∏ô‡∏¥‡πâ‡∏ß 2K ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏¥‡∏Å',
                status: 'maintenance',
                location: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 303'
            }
        ];

        window.initializeFirebase = function() {
            try {
                const configText = document.getElementById('firebaseConfig').value;
                const config = JSON.parse(configText);
                
                app = initializeApp(config);
                auth = getAuth(app);
                db = getFirestore(app);
                
                document.getElementById('configStatus').className = 'status success';
                document.getElementById('configStatus').textContent = '‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Firebase ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                document.getElementById('loginBtn').disabled = false;
                
                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        currentUser = user;
                        document.getElementById('authStatus').className = 'status success';
                        document.getElementById('authStatus').innerHTML = `
                            ‚úÖ Login ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à<br>
                            <strong>Email:</strong> ${user.email}<br>
                            <strong>UID:</strong> ${user.uid}
                        `;
                        document.getElementById('loginBtn').style.display = 'none';
                        document.getElementById('logoutBtn').style.display = 'inline-block';
                        document.getElementById('logoutBtn').disabled = false;
                        document.getElementById('addBtn').disabled = false;
                        document.getElementById('checkBtn').disabled = false;
                    } else {
                        currentUser = null;
                        document.getElementById('authStatus').className = 'status info';
                        document.getElementById('authStatus').textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login';
                        document.getElementById('loginBtn').style.display = 'inline-block';
                        document.getElementById('logoutBtn').style.display = 'none';
                        document.getElementById('addBtn').disabled = true;
                        document.getElementById('checkBtn').disabled = true;
                    }
                });
                
            } catch (error) {
                document.getElementById('configStatus').className = 'status error';
                document.getElementById('configStatus').textContent = '‚ùå Error: ' + error.message;
            }
        };

        window.loginWithGoogle = async function() {
            try {
                const provider = new GoogleAuthProvider();
                await signInWithPopup(auth, provider);
            } catch (error) {
                alert('Login Error: ' + error.message);
            }
        };

        window.logout = async function() {
            try {
                await signOut(auth);
            } catch (error) {
                alert('Logout Error: ' + error.message);
            }
        };

        window.addTestEquipment = async function() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="status info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>';
            
            try {
                const equipmentRef = collection(db, 'equipmentManagement');
                let successCount = 0;
                let errorCount = 0;
                const errors = [];

                for (const item of testEquipment) {
                    try {
                        const equipmentData = {
                            ...item,
                            createdAt: serverTimestamp(),
                            updatedAt: serverTimestamp(),
                            createdBy: currentUser.uid
                        };

                        await addDoc(equipmentRef, equipmentData);
                        successCount++;
                        console.log('Added:', item.name);
                    } catch (error) {
                        errorCount++;
                        errors.push({ item: item.name, error: error.message });
                        console.error('Error adding:', item.name, error);
                    }
                }

                let html = '<div class="section">';
                html += '<h2>üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>';
                
                if (successCount > 0) {
                    html += `<div class="status success">‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${successCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
                }
                
                if (errorCount > 0) {
                    html += `<div class="status error">‚ùå ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${errorCount} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
                    html += '<h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</h3>';
                    html += '<pre>' + JSON.stringify(errors, null, 2) + '</pre>';
                }
                
                html += '</div>';
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status error">‚ùå Error: ${error.message}</div>`;
                console.error('Add equipment error:', error);
            }
        };

        window.checkEquipment = async function() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="status info">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>';
            
            try {
                const equipmentRef = collection(db, 'equipmentManagement');
                const q = query(equipmentRef, orderBy('createdAt', 'desc'));
                const snapshot = await getDocs(q);
                
                let html = '<div class="section">';
                html += '<h2>üì¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>';
                html += `<div class="status success">‚úÖ ‡∏û‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ${snapshot.size} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>`;
                
                if (snapshot.size > 0) {
                    html += '<h3>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå:</h3>';
                    html += '<pre>';
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        html += `\nID: ${doc.id}\n`;
                        html += `‡∏ä‡∏∑‡πà‡∏≠: ${data.name}\n`;
                        html += `‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${data.category}\n`;
                        html += `‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${data.status}\n`;
                        html += `‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ${data.location}\n`;
                        html += '---\n';
                    });
                    html += '</pre>';
                } else {
                    html += '<div class="status info">‚ÑπÔ∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</div>';
                }
                
                html += '</div>';
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status error">‚ùå Error: ${error.message}</div>`;
                console.error('Check equipment error:', error);
            }
        };
    </script>
</body>
</html>
