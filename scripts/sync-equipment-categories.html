<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ã‡∏¥‡∏á‡∏Ñ‡πå Equipment Categories</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .status {
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .loading {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .category-card {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
        }
        .old-structure {
            border-left-color: #ff9800;
        }
        .new-structure {
            border-left-color: #4CAF50;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        button.danger {
            background: #f44336;
        }
        button.danger:hover {
            background: #da190b;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .column h3 {
            margin-top: 0;
        }
        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        .action-buttons {
            margin: 20px 0;
            padding: 20px;
            background: #fff3cd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå Equipment Categories</h1>
        
        <div class="info">
            <strong>üìã ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:</strong><br>
            ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏ö‡∏ß‡πà‡∏≤ equipmentCategories ‡∏°‡∏µ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£<br>
            Script ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        </div>

        <div id="status" class="status loading">
            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
        </div>

        <div class="action-buttons">
            <h3>‚öôÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</h3>
            <button onclick="analyzeCategories()">üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button onclick="migrateCategories()" id="migrateBtn" disabled>üîÑ ‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            <button onclick="createStandardCategories()" class="danger">üÜï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°)</button>
        </div>

        <div id="analysis" style="display:none;">
            <h2>üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h2>
            <div class="comparison">
                <div class="column">
                    <h3>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡πÄ‡∏Å‡πà‡∏≤)</h3>
                    <div id="oldStructure"></div>
                </div>
                <div class="column">
                    <h3>‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ (‡πÉ‡∏´‡∏°‡πà)</h3>
                    <div id="newStructure"></div>
                </div>
            </div>
        </div>

        <div id="results"></div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, getDocs, doc, setDoc, deleteDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyA9D6ReIlhiaaJ1g1Obd-dcjp2R0LO_eyo",
            authDomain: "equipment-lending-system-41b49.firebaseapp.com",
            projectId: "equipment-lending-system-41b49",
            storageBucket: "equipment-lending-system-41b49.firebasestorage.app",
            messagingSenderId: "47770598089",
            appId: "1:47770598089:web:9d898f247f742fe1686b18"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        window.analyzeCategories = analyzeCategories;
        window.migrateCategories = migrateCategories;
        window.createStandardCategories = createStandardCategories;

        let currentCategories = [];

        async function ensureAuth() {
            if (!auth.currentUser) {
                const provider = new GoogleAuthProvider();
                try {
                    await signInWithPopup(auth, provider);
                    console.log('‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } catch (error) {
                    console.error('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ:', error);
                    throw error;
                }
            }
        }

        async function analyzeCategories() {
            const statusDiv = document.getElementById('status');
            const analysisDiv = document.getElementById('analysis');
            const oldStructureDiv = document.getElementById('oldStructure');
            const newStructureDiv = document.getElementById('newStructure');
            const migrateBtn = document.getElementById('migrateBtn');

            try {
                await ensureAuth();
                
                statusDiv.className = 'status loading';
                statusDiv.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';

                const snapshot = await getDocs(collection(db, 'equipmentCategories'));

                if (snapshot.empty) {
                    statusDiv.className = 'status error';
                    statusDiv.textContent = '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• equipmentCategories';
                    return;
                }

                currentCategories = [];
                snapshot.forEach((doc) => {
                    currentCategories.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                // Show old structure
                oldStructureDiv.innerHTML = '';
                currentCategories.forEach(cat => {
                    const card = document.createElement('div');
                    card.className = 'category-card old-structure';
                    card.innerHTML = `
                        <strong>Document ID:</strong> ${cat.id}<br>
                        <pre>${JSON.stringify({
                            name: cat.name || 'N/A',
                            nameEn: cat.nameEn || 'N/A',
                            description: cat.description || 'N/A',
                            equipmentCount: cat.equipmentCount || 0,
                            color: cat.color || 'N/A',
                            icon: cat.icon || 'N/A',
                            level: cat.level || 'N/A',
                            parentId: cat.parentId || 'N/A'
                        }, null, 2)}</pre>
                    `;
                    oldStructureDiv.appendChild(card);
                });

                // Show new structure
                newStructureDiv.innerHTML = '';
                const mappings = getCategoryMappings();
                currentCategories.forEach(cat => {
                    const mapping = mappings.find(m => 
                        m.oldId === cat.id || 
                        m.nameEn === cat.nameEn ||
                        m.name === cat.name
                    );
                    
                    if (mapping) {
                        const card = document.createElement('div');
                        card.className = 'category-card new-structure';
                        card.innerHTML = `
                            <strong>Document ID:</strong> ${mapping.newId}<br>
                            <pre>${JSON.stringify({
                                name: mapping.nameTh,
                                description: mapping.description,
                                equipmentCount: cat.equipmentCount || 0
                            }, null, 2)}</pre>
                        `;
                        newStructureDiv.appendChild(card);
                    }
                });

                analysisDiv.style.display = 'block';
                migrateBtn.disabled = false;
                
                statusDiv.className = 'status success';
                statusDiv.innerHTML = `
                    ‚úÖ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô<br>
                    ‡∏û‡∏ö ${currentCategories.length} categories ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á
                `;

            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`;
                console.error(error);
            }
        }

        function getCategoryMappings() {
            return [
                { oldId: 'UkMESSIXrSH0GWI52ipi', nameEn: 'Laptops', name: '‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Å', newId: 'laptop', nameTh: '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Å', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏û‡∏Å‡∏û‡∏≤' },
                { nameEn: 'Projectors', newId: 'projector', nameTh: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏â‡∏≤‡∏¢‡∏†‡∏≤‡∏û', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏â‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠' },
                { nameEn: 'Cameras', newId: 'camera', nameTh: '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠' },
                { nameEn: 'Microphones', newId: 'microphone', nameTh: '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á' },
                { nameEn: 'Speakers', newId: 'speaker', nameTh: '‡∏•‡∏≥‡πÇ‡∏û‡∏á', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á' },
                { nameEn: 'Tablets', newId: 'tablet', nameTh: '‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™' },
                { nameEn: 'Monitors', newId: 'monitor', nameTh: '‡∏à‡∏≠‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå', description: '‡∏à‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•' },
                { nameEn: 'Printers', newId: 'printer', nameTh: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£' }
            ];
        }

        async function migrateCategories() {
            if (!confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?\n\n‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞:\n1. ‡∏™‡∏£‡πâ‡∏≤‡∏á documents ‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢ ID ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• equipmentCount\n3. ‡∏•‡∏ö documents ‡πÄ‡∏Å‡πà‡∏≤')) {
                return;
            }

            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');

            try {
                await ensureAuth();
                
                statusDiv.className = 'status loading';
                statusDiv.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
                resultsDiv.innerHTML = '<h3>üìù Log ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</h3>';

                const mappings = getCategoryMappings();
                const results = [];

                for (const cat of currentCategories) {
                    const mapping = mappings.find(m => 
                        m.oldId === cat.id || 
                        m.nameEn === cat.nameEn ||
                        m.name === cat.name
                    );

                    if (mapping) {
                        // Create new document
                        const newDocRef = doc(db, 'equipmentCategories', mapping.newId);
                        await setDoc(newDocRef, {
                            name: mapping.nameTh,
                            description: mapping.description,
                            equipmentCount: cat.equipmentCount || 0,
                            createdAt: cat.createdAt || serverTimestamp(),
                            createdBy: cat.createdBy || auth.currentUser.uid,
                            updatedAt: serverTimestamp()
                        });

                        results.push(`‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á: ${mapping.newId} (${mapping.nameTh})`);

                        // Delete old document if different ID
                        if (cat.id !== mapping.newId) {
                            const oldDocRef = doc(db, 'equipmentCategories', cat.id);
                            await deleteDoc(oldDocRef);
                            results.push(`üóëÔ∏è  ‡∏•‡∏ö: ${cat.id}`);
                        }
                    } else {
                        results.push(`‚ö†Ô∏è  ‡∏Ç‡πâ‡∏≤‡∏°: ${cat.id} (‡πÑ‡∏°‡πà‡∏û‡∏ö mapping)`);
                    }
                }

                resultsDiv.innerHTML += results.map(r => `<div>${r}</div>`).join('');
                
                statusDiv.className = 'status success';
                statusDiv.innerHTML = `
                    ‚úÖ ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!<br>
                    ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• ${currentCategories.length} categories
                `;

                setTimeout(() => {
                    analyzeCategories();
                }, 2000);

            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`;
                console.error(error);
            }
        }

        async function createStandardCategories() {
            if (!confirm('‚ö†Ô∏è ‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô!\n\n‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• categories ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà\n\n‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                return;
            }

            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');

            try {
                await ensureAuth();
                
                statusDiv.className = 'status loading';
                statusDiv.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤...';
                resultsDiv.innerHTML = '<h3>üìù Log ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</h3>';

                // Delete all existing categories
                const snapshot = await getDocs(collection(db, 'equipmentCategories'));
                const deletePromises = [];
                snapshot.forEach((docSnapshot) => {
                    deletePromises.push(deleteDoc(doc(db, 'equipmentCategories', docSnapshot.id)));
                    resultsDiv.innerHTML += `<div>üóëÔ∏è  ‡∏•‡∏ö: ${docSnapshot.id}</div>`;
                });
                await Promise.all(deletePromises);

                statusDiv.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...';

                // Create standard categories
                const standardCategories = [
                    { id: 'laptop', name: '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÇ‡∏ô‡πâ‡∏ï‡∏ö‡∏∏‡πä‡∏Å', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏û‡∏Å‡∏û‡∏≤' },
                    { id: 'projector', name: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏â‡∏≤‡∏¢‡∏†‡∏≤‡∏û', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏â‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠' },
                    { id: 'camera', name: '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠' },
                    { id: 'microphone', name: '‡πÑ‡∏°‡πÇ‡∏Ñ‡∏£‡πÇ‡∏ü‡∏ô', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á' },
                    { id: 'speaker', name: '‡∏•‡∏≥‡πÇ‡∏û‡∏á', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á' },
                    { id: 'tablet', name: '‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏•‡πá‡∏ï', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™' },
                    { id: 'monitor', name: '‡∏à‡∏≠‡∏°‡∏≠‡∏ô‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå', description: '‡∏à‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•' },
                    { id: 'printer', name: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå', description: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£' }
                ];

                for (const cat of standardCategories) {
                    const docRef = doc(db, 'equipmentCategories', cat.id);
                    await setDoc(docRef, {
                        name: cat.name,
                        description: cat.description,
                        equipmentCount: 0,
                        createdAt: serverTimestamp(),
                        createdBy: auth.currentUser.uid,
                        updatedAt: serverTimestamp()
                    });
                    resultsDiv.innerHTML += `<div>‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á: ${cat.id} (${cat.name})</div>`;
                }

                statusDiv.className = 'status success';
                statusDiv.innerHTML = `
                    ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!<br>
                    ‡∏™‡∏£‡πâ‡∏≤‡∏á ${standardCategories.length} categories
                `;

                setTimeout(() => {
                    analyzeCategories();
                }, 2000);

            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.textContent = `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`;
                console.error(error);
            }
        }

        // Auto-analyze on load
        window.addEventListener('load', () => {
            setTimeout(analyzeCategories, 1000);
        });
    </script>
</body>
</html>
