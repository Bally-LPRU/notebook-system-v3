# คู่มือผู้ดูแลระบบยืม-คืนโน็คบุคและอุปกรณ์คอมพิวเตอร์

## สารบัญ
1. [ภาพรวมระบบ](#ภาพรวมระบบ)
2. [การเข้าสู่ระบบและสิทธิ์การใช้งาน](#การเข้าสู่ระบบและสิทธิ์การใช้งาน)
3. [การจัดการผู้ใช้](#การจัดการผู้ใช้)
4. [การจัดการอุปกรณ์](#การจัดการอุปกรณ์)
5. [การจัดการคำขอยืม](#การจัดการคำขอยืม)
6. [การจัดการการจอง](#การจัดการการจอง)
7. [รายงานและสถิติ](#รายงานและสถิติ)
8. [การตั้งค่าระบบ](#การตั้งค่าระบบ)
9. [การบำรุงรักษาระบบ](#การบำรุงรักษาระบบ)
10. [การแก้ไขปัญหา](#การแก้ไขปัญหา)

## ภาพรวมระบบ

### วัตถุประสงค์ของระบบ
ระบบยืม-คืนโน็คบุคและอุปกรณ์คอมพิวเตอร์ถูกพัฒนาขึ้นเพื่อ:
- จัดการการยืม-คืนอุปกรณ์อย่างเป็นระบบ
- ติดตามสถานะอุปกรณ์แบบ real-time
- ลดขั้นตอนการทำงานด้วยกระดาษ
- สร้างรายงานและสถิติการใช้งาน
- เพิ่มประสิทธิภาพการจัดการทรัพยากร

### สถาปัตยกรรมระบบ
- **Frontend**: React.js พร้อม responsive design
- **Backend**: Firebase (Firestore, Authentication, Storage)
- **Hosting**: Vercel หรือ Firebase Hosting
- **Database**: Cloud Firestore (NoSQL)
- **Authentication**: Google OAuth 2.0

### บทบาทผู้ใช้งาน
1. **ผู้ใช้ทั่วไป**: นักศึกษา, อาจารย์, เจ้าหน้าที่
2. **ผู้ดูแลระบบ**: มีสิทธิ์จัดการทุกส่วนของระบบ

## การเข้าสู่ระบบและสิทธิ์การใช้งาน

### การเข้าสู่ระบบ
1. เข้าสู่ระบบด้วยบัญชี Google ที่มีสิทธิ์ Admin
2. ระบบจะตรวจสอบสิทธิ์และนำไปยังหน้า Admin Dashboard

### สิทธิ์การใช้งาน Admin
- จัดการผู้ใช้ (อนุมัติ, ปฏิเสธ, แก้ไขสิทธิ์)
- จัดการอุปกรณ์ (เพิ่ม, แก้ไข, ลบ)
- อนุมัติ/ปฏิเสธคำขอยืม
- จัดการการจอง
- ดูรายงานและสถิติ
- ตั้งค่าระบบ

## การจัดการผู้ใช้

### การอนุมัติผู้ใช้ใหม่
1. **ไปที่หน้า "การอนุมัติผู้ใช้"**
2. **ดูรายการผู้ใช้ที่รอการอนุมัติ**
   - ข้อมูลส่วนตัว
   - ประเภทผู้ใช้
   - วันที่สมัคร
3. **ตัดสินใจอนุมัติหรือปฏิเสธ**
   - คลิก "อนุมัติ" เพื่ออนุมัติ
   - คลิก "ปฏิเสธ" พร้อมระบุเหตุผล
4. **ผู้ใช้จะได้รับการแจ้งเตือนผลการพิจารณา**

### การจัดการสิทธิ์ผู้ใช้
1. **ไปที่หน้า "จัดการผู้ใช้"**
2. **ค้นหาผู้ใช้ที่ต้องการแก้ไข**
3. **แก้ไขข้อมูล**:
   - เปลี่ยนสถานะ (อนุมัติ/ระงับ/ปฏิเสธ)
   - เปลี่ยนบทบาท (ผู้ใช้/ผู้ดูแล)
   - แก้ไขข้อมูลส่วนตัว
4. **บันทึกการเปลี่ยนแปลง**

### การระงับหรือลบผู้ใช้
1. **การระงับ**: เปลี่ยนสถานะเป็น "ระงับ"
   - ผู้ใช้ไม่สามารถเข้าใช้ระบบได้
   - ข้อมูลยังคงอยู่ในระบบ
2. **การลบ**: ลบข้อมูลผู้ใช้ออกจากระบบ
   - ใช้เฉพาะกรณีจำเป็น
   - ข้อมูลจะถูกลบถาวร

## การจัดการอุปกรณ์

### การเพิ่มอุปกรณ์ใหม่
1. **ไปที่หน้า "จัดการอุปกรณ์"**
2. **คลิกปุ่ม "เพิ่มอุปกรณ์"**
3. **กรอกข้อมูลอุปกรณ์**:
   - ชื่ออุปกรณ์
   - หมวดหมู่
   - รุ่น/ยี่ห้อ
   - Serial Number
   - คำอธิบาย
   - ตำแหน่งเก็บ
   - สถานะเริ่มต้น
4. **อัพโหลดรูปภาพ** (ถ้ามี)
5. **บันทึกข้อมูล**

### การแก้ไขข้อมูลอุปกรณ์
1. **ค้นหาอุปกรณ์ที่ต้องการแก้ไข**
2. **คลิกปุ่ม "แก้ไข"**
3. **ปรับปรุงข้อมูล**:
   - ข้อมูลทั่วไป
   - สถานะ
   - รูปภาพ
4. **บันทึกการเปลี่ยนแปลง**

### การจัดการสถานะอุปกรณ์
**สถานะที่มี**:
- **ว่าง**: พร้อมให้ยืม
- **ถูกยืม**: มีผู้ยืมอยู่
- **ซ่อมบำรุง**: อยู่ระหว่างการซ่อม
- **เลิกใช้**: ไม่สามารถยืมได้

**การเปลี่ยนสถานะ**:
1. เลือกอุปกรณ์
2. เปลี่ยนสถานะ
3. ระบุเหตุผล (ถ้าจำเป็น)
4. บันทึกการเปลี่ยนแปลง

### การลบอุปกรณ์
1. **เปลี่ยนสถานะเป็น "เลิกใช้"** ก่อน
2. **ตรวจสอบว่าไม่มีการยืมค้างอยู่**
3. **คลิกปุ่ม "ลบ"**
4. **ยืนยันการลบ**

## การจัดการคำขอยืม

### การดูคำขอยืมทั้งหมด
1. **ไปที่หน้า "คำขอยืม"**
2. **ดูรายการคำขอ** แยกตามสถานะ:
   - รอการอนุมัติ
   - อนุมัติแล้ว
   - ปฏิเสธ
   - กำลังยืม
   - คืนแล้ว

### การอนุมัติคำขอยืม
1. **เลือกคำขอที่รอการอนุมัติ**
2. **ตรวจสอบข้อมูล**:
   - ข้อมูลผู้ยืม
   - อุปกรณ์ที่ขอยืม
   - วันที่ยืม-คืน
   - วัตถุประสงค์
3. **ตัดสินใจ**:
   - **อนุมัติ**: คลิก "อนุมัติ"
   - **ปฏิเสธ**: คลิก "ปฏิเสธ" พร้อมระบุเหตุผล
4. **ผู้ยืมจะได้รับการแจ้งเตือน**

### การจัดการการยืม-คืน
1. **การส่งมอบอุปกรณ์**:
   - เปลี่ยนสถานะเป็น "กำลังยืม"
   - บันทึกวันที่ส่งมอบจริง
   - ตรวจสอบสภาพอุปกรณ์

2. **การรับคืนอุปกรณ์**:
   - ตรวจสอบสภาพอุปกรณ์
   - บันทึกวันที่รับคืนจริง
   - เปลี่ยนสถานะเป็น "คืนแล้ว"
   - อัพเดทสถานะอุปกรณ์เป็น "ว่าง"

### การติดตามอุปกรณ์ค้างคืน
1. **ดูรายการอุปกรณ์ค้างคืน**
2. **ส่งการแจ้งเตือน** ให้ผู้ยืม
3. **ติดต่อผู้ยืมโดยตรง** (ถ้าจำเป็น)
4. **บันทึกการดำเนินการ**

## การจัดการการจอง

### การดูปฏิทินการจอง
1. **ไปที่หน้า "การจอง"**
2. **ดูปฏิทินรายเดือน/รายสัปดาห์**
3. **ดูรายละเอียดการจอง** โดยคลิกที่ช่วงเวลา

### การอนุมัติการจอง
1. **ดูรายการการจองที่รอการอนุมัติ**
2. **ตรวจสอบความขัดแย้งของเวลา**
3. **อนุมัติหรือปฏิเสธ** พร้อมเหตุผล

### การแก้ไขการจอง
1. **เลือกการจองที่ต้องการแก้ไข**
2. **ปรับเปลี่ยน**:
   - วันที่และเวลา
   - สถานะ
   - หมายเหตุ
3. **แจ้งเตือนผู้จอง** เกี่ยวกับการเปลี่ยนแปลง

## รายงานและสถิติ

### รายงานการใช้งาน
1. **รายงานรายวัน/รายเดือน/รายปี**
2. **สถิติการยืม-คืน**:
   - จำนวนครั้งการยืม
   - อุปกรณ์ที่ได้รับความนิยม
   - ผู้ใช้ที่ยืมบ่อย
3. **รายงานสถานะอุปกรณ์**:
   - อุปกรณ์ที่ใช้งานได้
   - อุปกรณ์ที่ต้องซ่อม
   - อุปกรณ์ที่เลิกใช้

### การส่งออกรายงาน
1. **เลือกประเภทรายงาน**
2. **กำหนดช่วงเวลา**
3. **เลือกรูปแบบ**: PDF, Excel, CSV
4. **ดาวน์โหลดรายงาน**

### แดชบอร์ดสำหรับผู้ดูแล
- **สถิติแบบ real-time**
- **กราฟการใช้งาน**
- **การแจ้งเตือนสำคัญ**
- **รายการงานที่ต้องดำเนินการ**

## การตั้งค่าระบบ

### การตั้งค่าทั่วไป
1. **ข้อมูลองค์กร**:
   - ชื่อองค์กร
   - ที่อยู่
   - ข้อมูลติดต่อ
2. **การตั้งค่าเวลา**:
   - เขตเวลา
   - รูปแบบวันที่
3. **ภาษา**: ไทย/อังกฤษ

### การตั้งค่าการแจ้งเตือน
1. **ประเภทการแจ้งเตือน**:
   - การแจ้งเตือนการคืน
   - การแจ้งเตือนการจอง
   - การแจ้งเตือนผู้ดูแล
2. **ช่องทางการแจ้งเตือน**:
   - ในระบบ
   - อีเมล (ถ้าตั้งค่า)

### การจัดการหมวดหมู่อุปกรณ์
1. **เพิ่มหมวดหมู่ใหม่**
2. **แก้ไขหมวดหมู่ที่มีอยู่**
3. **ลบหมวดหมู่** (ถ้าไม่มีอุปกรณ์ใช้งาน)

## การบำรุงรักษาระบบ

### การสำรองข้อมูล
1. **Firebase มีการสำรองข้อมูลอัตโนมัติ**
2. **สามารถ export ข้อมูลเพิ่มเติม**:
   - ข้อมูลผู้ใช้
   - ข้อมูลอุปกรณ์
   - ประวัติการยืม-คืน

### การตรวจสอบประสิทธิภาพ
1. **ตรวจสอบความเร็วการโหลด**
2. **ดูสถิติการใช้งาน**
3. **ตรวจสอบ error logs**

### การอัพเดทระบบ
1. **ตรวจสอบการอัพเดท**
2. **ทดสอบในสภาพแวดล้อม staging**
3. **อัพเดท production**
4. **ตรวจสอบการทำงานหลังอัพเดท**

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย

#### 1. ผู้ใช้ไม่สามารถเข้าสู่ระบบได้
**สาเหตุ**:
- บัญชียังไม่ได้รับการอนุมัติ
- ปัญหาการเชื่อมต่อ Google OAuth
- บัญชีถูกระงับ

**วิธีแก้ไข**:
1. ตรวจสอบสถานะบัญชีผู้ใช้
2. ตรวจสอบการตั้งค่า OAuth
3. ลองรีเซ็ตสถานะบัญชี

#### 2. อุปกรณ์ไม่แสดงในรายการ
**สาเหตุ**:
- สถานะอุปกรณ์ไม่ถูกต้อง
- ปัญหาการซิงค์ข้อมูล
- การตั้งค่าการแสดงผล

**วิธีแก้ไข**:
1. ตรวจสอบสถานะอุปกรณ์
2. รีเฟรชข้อมูล
3. ตรวจสอบการตั้งค่าการกรอง

#### 3. การแจ้งเตือนไม่ทำงาน
**สาเหตุ**:
- การตั้งค่าการแจ้งเตือนปิดอยู่
- ปัญหาการเชื่อมต่อ
- การตั้งค่าเบราว์เซอร์

**วิธีแก้ไข**:
1. ตรวจสอบการตั้งค่าการแจ้งเตือน
2. ตรวจสอบการอนุญาตของเบราว์เซอร์
3. ทดสอบการส่งการแจ้งเตือน

### การติดต่อฝ่ายเทคนิค
- **ปัญหาเร่งด่วน**: โทรศัพท์
- **ปัญหาทั่วไป**: อีเมล
- **การขอความช่วยเหลือ**: ระบบ ticket

### การบันทึกปัญหา
1. **บันทึกรายละเอียดปัญหา**
2. **ขั้นตอนการแก้ไข**
3. **ผลลัพธ์**
4. **การป้องกันในอนาคต**

## ภาคผนวก

### คำสั่งที่มีประโยชน์

#### การตรวจสอบสถานะระบบ
```bash
# ตรวจสอบการเชื่อมต่อ Firebase
firebase projects:list

# ตรวจสอบ Firestore rules
firebase firestore:rules:get

# ดู logs
firebase functions:log
```

#### การสำรองข้อมูล
```bash
# Export Firestore data
gcloud firestore export gs://[BUCKET_NAME]

# Import Firestore data
gcloud firestore import gs://[BUCKET_NAME]/[EXPORT_FOLDER]
```

### รายการตรวจสอบประจำ

#### รายวัน
- [ ] ตรวจสอบคำขอยืมใหม่
- [ ] ตรวจสอบอุปกรณ์ค้างคืน
- [ ] ตรวจสอบการจองวันนี้
- [ ] ตรวจสอบการแจ้งเตือนที่ส่งไม่สำเร็จ

#### รายสัปดาห์
- [ ] ตรวจสอบสถิติการใช้งาน
- [ ] ตรวจสอบสถานะอุปกรณ์
- [ ] ตรวจสอบผู้ใช้ใหม่ที่รอการอนุมัติ
- [ ] ตรวจสอบประสิทธิภาพระบบ

#### รายเดือน
- [ ] สร้างรายงานสรุป
- [ ] ตรวจสอบการสำรองข้อมูล
- [ ] ตรวจสอบการอัพเดทระบบ
- [ ] ทบทวนการตั้งค่าระบบ

---

**หมายเหตุ**: คู่มือนี้จะมีการปรับปรุงตามการพัฒนาระบบ กรุณาตรวจสอบเวอร์ชันล่าสุดเป็นประจำ

**เวอร์ชัน**: 1.0  
**วันที่อัพเดท**: [วันที่ปัจจุบัน]  
**ผู้จัดทำ**: ทีมพัฒนาระบบยืม-คืนโน็คบุคและอุปกรณ์คอมพิวเตอร์